
## インターセクションオブザーバーでパララックスを実装する

```4D
document.addEventListener('DOMContentLoaded', function () {
    const ta = new TextAnimation('.animate-title');
    ta.animate();

    const els = document.querySelectorAll('.animate-title');
    const cb = function(entries, observer) {
    entries.forEach(entry => {
        if(entry.isIntersecting) {
        console.log('inview');
        entry.target.classList.add('inview');
        // observer.unobserve(entry.target)
        } else {
        console.log('out view');
        entry.target.classList.remove('inview');
        }
    })
    }
    const options = {
    rootMargin: "-100px 0px",
    threshold: 1
    }
    const io = new IntersectionObserver(cb, options);
    io.observe(els);
});
```

①　対象とするDOMが複数存在するので、`querySelectorAll()` としてあげる。  

②　こちら複数の要素に対して監視を行う必要があるので、  
　　`forEach()` メソッドで `els` に格納されている要素を、一つずつループさせてやる。  

③　一度アニメーションを実行したら監視を切りたいので、`observer.unobserve()` を呼んであげる。  

④　このままでも動きそうだが、実はこの状態ではうまく動かない。  

<br>

[　この状態で動かしてみた例。]()

<br>

　　これは何が起こっているかというと